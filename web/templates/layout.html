{{define "layout"}}<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>saws</title>
  <link rel="stylesheet" href="/static/styles.css">
  <script src="https://unpkg.com/htmx.org@2.0.4"></script>
</head>
<body>
  <header>
    <h1><span>saws</span></h1>
    <div id="header-right">
      <span id="synced-at-label" class="synced-at-label">{{.SyncedAt}}</span>
      <div class="sync-split">
        <button class="icon-btn" id="sync-btn"
          hx-post="{{if eq .Tab "compute"}}/sync/compute{{else if eq .Tab "s3"}}/sync/s3{{else if eq .Tab "database"}}/sync/database{{else if eq .Tab "iam"}}/sync/iam{{else if eq .Tab "net"}}/sync/vpc{{else}}/sync/all{{end}}"
          hx-target="{{if eq .Tab "compute"}}#compute-content{{else if eq .Tab "s3"}}#s3-content{{else if eq .Tab "database"}}#database-content{{else if eq .Tab "iam"}}#iam-content{{else if eq .Tab "net"}}#vpc-content{{else}}#app{{end}}"
          hx-swap="innerHTML"
          hx-vals='{"region":"{{.CurrentRegion}}","tab":"{{.Tab}}"}'
          hx-indicator="#sync-btn"
          title="Sync">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21.5 2v6h-6"/><path d="M2.5 22v-6h6"/><path d="M2.5 11.5a10 10 0 0 1 18.4-4.5"/><path d="M21.5 12.5a10 10 0 0 1-18.4 4.5"/>
          </svg>
        </button>
        <button class="icon-btn sync-chevron" onclick="this.parentElement.classList.toggle('open')" title="Sync options">
          <svg width="10" height="10" viewBox="0 0 12 12" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 4l4 4 4-4"/></svg>
        </button>
        <div class="sync-dropdown">
          <button class="sync-dropdown-item"
            hx-post="/sync/all"
            hx-target="#app"
            hx-swap="innerHTML"
            hx-vals='{"region":"{{.CurrentRegion}}","tab":"{{.Tab}}"}'
            hx-indicator="#sync-btn"
            onclick="this.closest('.sync-split').classList.remove('open')">
            Sync all
          </button>
        </div>
      </div>
      <div id="region-select-wrapper">
        {{template "region-dropdown" .}}
      </div>
      <button class="icon-btn" hx-get="/settings/regions" hx-target="#panel-container" hx-swap="innerHTML" title="Region settings">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="2" r="2"/><path d="M12 8v13"/><path d="M5 3a2 2 0 1 0 0 4"/><path d="M5 7v13"/><path d="M19 3a2 2 0 1 1 0 4"/><path d="M19 7v13"/><path d="M2 21h20"/>
        </svg>
      </button>
      <button class="icon-btn" hx-get="/profile" hx-target="#panel-container" hx-swap="innerHTML" title="AWS profile">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/>
        </svg>
      </button>
    </div>
  </header>
  <main id="app">
    {{template "content" .}}
  </main>
  <div id="panel-container"></div>
  <div id="detail-container"></div>
</body>
</html>{{end}}
